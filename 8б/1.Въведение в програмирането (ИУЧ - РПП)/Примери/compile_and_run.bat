@echo off
REM –°–∫—Ä–∏–ø—Ç –∑–∞ –∫–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ –∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ C# –ø—Ä–∏–º–µ—Ä–∏ –∑–∞ Windows
REM –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ: compile_and_run.bat [–∏–º–µ_–Ω–∞_—Ñ–∞–π–ª–∞.cs]

echo === C# –ö–æ–º–ø–∏–ª–∞—Ç–æ—Ä –∏ –ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª –∑–∞ Windows ===

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –µ –ø–æ–¥–∞–¥–µ–Ω –∞—Ä–≥—É–º–µ–Ω—Ç
if "%1"=="" (
    echo –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ: %0 [–∏–º–µ_–Ω–∞_—Ñ–∞–π–ª–∞.cs]
    echo.
    echo –ù–∞–ª–∏—á–Ω–∏ –ø—Ä–∏–º–µ—Ä–∏:
    dir *.cs /b | findstr /v Template
    goto :end
)

REM –ò–º–µ –Ω–∞ —Ñ–∞–π–ª–∞
set FILENAME=%1

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ —Ñ–∞–π–ª—ä—Ç —Å—ä—â–µ—Å—Ç–≤—É–≤–∞
if not exist "%FILENAME%" (
    echo –ì—Ä–µ—à–∫–∞: –§–∞–π–ª—ä—Ç '%FILENAME%' –Ω–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞!
    goto :end
)

REM –ò–º–µ –Ω–∞ –∏–∑–ø—ä–ª–Ω–∏–º–∏—è —Ñ–∞–π–ª (–±–µ–∑ —Ä–∞–∑—à–∏—Ä–µ–Ω–∏–µ—Ç–æ)
for %%F in ("%FILENAME%") do set EXECUTABLE=%%~nF

echo –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ –Ω–∞ %FILENAME%...

REM –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ
csc /out:"%EXECUTABLE%.exe" "%FILENAME%"

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ—Ç–æ –µ —É—Å–ø–µ—à–Ω–æ
if %ERRORLEVEL% EQU 0 (
    echo ‚úÖ –ö–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ—Ç–æ –µ —É—Å–ø–µ—à–Ω–æ!
    echo –ò–∑–ø—ä–ª–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞—Ç–∞...
    echo ================================
    
    REM –ò–∑–ø—ä–ª–Ω–µ–Ω–∏–µ
    "%EXECUTABLE%.exe"
    
    echo ================================
    echo ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–∞—Ç–∞ –ø—Ä–∏–∫–ª—é—á–∏!
    
    REM –ò–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ –∏–∑–ø—ä–ª–Ω–∏–º–∏—è —Ñ–∞–π–ª
    del "%EXECUTABLE%.exe" >nul 2>&1
    echo üßπ –ò–∑–ø—ä–ª–Ω–∏–º–∏—è—Ç —Ñ–∞–π–ª –µ –∏–∑—Ç—Ä–∏—Ç.
) else (
    echo ‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–º–ø–∏–ª–∏—Ä–∞–Ω–µ!
    echo –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –∏–º–∞—Ç–µ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–Ω .NET Framework SDK
)

:end
pause
