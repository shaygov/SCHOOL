ИНСТРУКЦИИ ЗА СЪЗДАВАНЕ НА PIVOT ТАБЛИЦА В LIBREOFFICE CALC
=============================================================

Файлът данни-обобщени-таблици-11а.xlsx съдържа:
- Колони A-G: Оригинални данни (140 записа)
- Колони K-Q: Примерен резултат (статична таблица)

НАСТРОЙКИ НА ПРИМЕРНАТА PIVOT ТАБЛИЦА:
---------------------------------------

1. РЕДОВЕ (Row Fields): Категория
2. КОЛОНИ (Column Fields): Регион
3. СТОЙНОСТИ (Data Fields): Сума от "Продажби"
4. ФИЛТРИ (Page Fields): Няма

═══════════════════════════════════════════════════════════════════

СТЪПКА 1: ПОДГОТОВКА НА ДАННИТЕ
---------------------------------

1. Отвори файла данни-обобщени-таблици-11а.xlsx в LibreOffice Calc
2. Кликни на клетка A1 (заглавието)
3. Използвай Ctrl+Shift+End за да маркираш всички данни
   (Или маркирай ръчно от A1 до G141)

ВАЖНО: Данните трябва да имат:
- Заглавия в първия ред
- Без празни редове или колони
- Всички колони с еднакъв формат

═══════════════════════════════════════════════════════════════════

СТЪПКА 2: СЪЗДАВАНЕ НА PIVOT ТАБЛИЦА
--------------------------------------

1. С маркирани данни, отиди в менюто:
   Insert → Pivot Table → Insert or Edit...

2. Появява се диалогов прозорец "Select Source":
   - Current selection (маркираният диапазон)
   - Data range: Sheet.$A$1:$G$141
   
3. Натисни OK

4. Отваря се голям диалогов прозорец "Pivot Table"
   с четири области и списък на полетата отляво

═══════════════════════════════════════════════════════════════════

СТЪПКА 3: КОНФИГУРИРАНЕ НА ПОЛЕТАТА
-------------------------------------

В диалоговия прозорец виждаш:

ЛЯВО: Списък "Available Fields" с всички колони:
- Дата
- Продукт
- Категория
- Регион
- Цена
- Количество
- Продажби

ДЯСНО: Четири области за полета:
- Page Fields (Филтри)
- Column Fields (Колони)
- Row Fields (Редове)
- Data Fields (Стойности)

ДЕЙСТВИЯ:

1. ВЛАЧИ "Категория" от списъка в областта "Row Fields"
   (Или двоен клик на "Категория")

2. ВЛАЧИ "Регион" в областта "Column Fields"

3. ВЛАЧИ "Продажби" в областта "Data Fields"

ЗАБЕЛЕЖКА:
LibreOffice автоматично използва SUM за числови полета.
В "Data Fields" виждаш "Sum - Продажби".

═══════════════════════════════════════════════════════════════════

СТЪПКА 4: НАСТРОЙКА НА ИЗЧИСЛЕНИЯТА
-------------------------------------

Ако искаш да промениш агрегацията:

1. В областта "Data Fields" виждаш "Sum - Продажби"
2. Двоен клик на това поле
3. Появява се диалогов прозорец "Data Field"

4. Можеш да избереш:
   - Function: Sum (по подразбиране)
   - Други: Average, Max, Min, Count, Product
   
5. Показване като:
   - Normal (стандартно число)
   - % of row, % of column, % of total
   - Difference from, Index
   
6. Натисни OK

═══════════════════════════════════════════════════════════════════

СТЪПКА 5: СЪЗДАВАНЕ НА ТАБЛИЦАТА
----------------------------------

1. След конфигурирането на полетата, натисни OK
   в главния диалогов прозорец

2. LibreOffice създава нов лист с Pivot таблицата
   (Листът обикновено се казва "Sheet1", "Sheet2" и т.н.)

3. Таблицата показва:
   - По редове: Електроника, Периферия, Софтуер, Консумативи
   - По колони: София, Пловдив, Варна, Бургас, Русе, Стара Загора
   - Стойности: Суми на продажбите
   - Общи суми (Total)

═══════════════════════════════════════════════════════════════════

СТЪПКА 6: РЕДАКТИРАНЕ НА PIVOT ТАБЛИЦА
----------------------------------------

За да промениш настройките:

1. Кликни НАВСЯКЪДЕ в Pivot таблицата
2. Insert → Pivot Table → Insert or Edit...
3. Появява се същият диалогов прозорец
4. Направи промените
5. OK

Можеш да:
- Добавяш/премахваш полета
- Променяш реда на полетата
- Сменяш агрегациите

═══════════════════════════════════════════════════════════════════

ДОПЪЛНИТЕЛНИ ФУНКЦИИ
---------------------

А) ФИЛТРИРАНЕ

1. Добавяне на филтър:
   - ВЛАЧИ "Продукт" в областта "Page Fields"
   - Над таблицата се появява падащо меню
   - Избери конкретни продукти за показване

2. Филтриране в редове/колони:
   - В Pivot таблицата има бутон до "Категория" и "Регион"
   - Кликни на бутона
   - Премахни отметки от нежеланите стойности

Б) ГРУПИРАНЕ ПО ДАТИ

1. Добави "Дата" в Row Fields
2. След създаване на таблицата, десен клик на дата
3. Outline → Group...
4. Избери: Days, Months, Quarters, Years
5. OK

В) СОРТИРАНЕ

1. Кликни на клетка в таблицата
2. Data → Sort...
3. Избери колона и ред (Ascending/Descending)
4. OK

Г) ДОПЪЛНИТЕЛНО ПОЛЕ (БРОЙ)

1. ВЛАЧИ "Продажби" още веднъж в Data Fields
2. Двоен клик на новото поле
3. Function: Count
4. OK

Д) ПОКАЗВАНЕ КАТО ПРОЦЕНТ

1. Двоен клик на полето в Data Fields
2. Таб "Options"
3. Display Value: "Percentage of column" или "Percentage of total"
4. OK

═══════════════════════════════════════════════════════════════════

АКТУАЛИЗИРАНЕ НА ДАННИТЕ
--------------------------

Ако промениш оригиналните данни:

МЕТОД 1:
1. Кликни върху Pivot таблицата
2. Data → Pivot Table → Refresh

МЕТОД 2:
1. Десен клик на таблицата
2. Refresh

Ако добавиш нови редове:

1. Кликни върху Pivot таблицата
2. Insert → Pivot Table → Insert or Edit...
3. Смени Data range на по-голям диапазон (напр. $A$1:$G$200)
4. OK два пъти

═══════════════════════════════════════════════════════════════════

ФОРМАТИРАНЕ НА ТАБЛИЦАТА
--------------------------

1. Автоформат:
   - Кликни в таблицата
   - Format → AutoFormat Styles
   - Избери стил
   - OK

2. Ръчно форматиране:
   - Маркирай клетки
   - Format → Cells
   - Избери Number format, Font, Background
   - OK

3. Показване на общи суми:
   - Insert → Pivot Table → Insert or Edit...
   - Options → Total columns/rows
   - Избери "Automatic" или "User-defined"

═══════════════════════════════════════════════════════════════════

КЛАВИШНИ КОМБИНАЦИИ
---------------------

F5              - Navigator (преглед на всички Pivot таблици)
Ctrl+Shift+End  - Избор до края на данните
Ctrl+Home       - Отиване в началото на листа

═══════════════════════════════════════════════════════════════════

ЧЕСТИ ГРЕШКИ И РЕШЕНИЯ
------------------------

Проблем: "No data range selected"
Решение: Маркирай данните преди Insert → Pivot Table

Проблем: Таблицата не се актуализира
Решение: Data → Pivot Table → Refresh

Проблем: Виждам "Count" вместо "Sum"
Решение: Двоен клик на полето в Data Fields → Function: Sum

Проблем: Не мога да редактирам таблицата
Решение: LibreOffice Pivot таблици се редактират само чрез диалоговия прозорец

Проблем: Липсва бутон за филтриране
Решение: Insert → Pivot Table → Insert or Edit → Options → "Display filter button"

═══════════════════════════════════════════════════════════════════

ЕКСПОРТИРАНЕ НА РЕЗУЛТАТА
---------------------------

За статично копие на таблицата:

1. Маркирай цялата Pivot таблица
2. Ctrl+C (Copy)
3. Отиди на нов лист
4. Edit → Paste Special → Paste Special...
5. Избери "Text" и "Numbers"
6. Премахни отметката от "Formats"
7. OK
8. Получаваш статична таблица без връзка към данните

═══════════════════════════════════════════════════════════════════

РАЗЛИКИ СПРЯМО EXCEL
----------------------

1. LibreOffice използва диалогов прозорец вместо панел
2. Влаченето на полета е по-различно (можеш да използваш двоен клик)
3. Няма Slicers (визуални филтри като в Excel)
4. Няма Timeline за дати
5. Редактирането става само чрез Insert → Pivot Table → Insert or Edit
6. Refresh не е автоматичен - трябва да го правиш ръчно

═══════════════════════════════════════════════════════════════════

СЪВЕТИ ЗА РАБОТА
-----------------

1. Винаги проверявай Data range преди създаване на таблицата
2. Използвай Named Ranges за по-лесно управление на данните
3. Запазвай файла след всяка промяна в Pivot таблицата
4. Ако таблицата изглежда объркано, създай я отново
5. При сложни анализи създай няколко различни Pivot таблици

