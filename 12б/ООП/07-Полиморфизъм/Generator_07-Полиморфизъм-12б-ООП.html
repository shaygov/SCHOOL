<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Полиморфизъм — 12б, ООП</title>
    <style>
        body {
            font-family: 'DejaVu Serif', 'Times New Roman', serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #fd7e14;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 4px solid #fd7e14;
            padding-left: 15px;
            margin-top: 30px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 25px;
        }
        
        ul {
            margin: 15px 0;
        }
        
        li {
            margin: 8px 0;
        }
        
        code {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        
        pre {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-wrap: break-word;
            margin: 15px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        
        .example {
            background-color: #e8f5e8;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
        
        .important {
            background-color: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 15px 0;
        }
        
        .config {
            background-color: #e3f2fd;
            padding: 15px;
            border-left: 4px solid #2196f3;
            margin: 15px 0;
        }
        
        .patterns {
            background-color: #f3e5f5;
            padding: 15px;
            border-left: 4px solid #9c27b0;
            margin: 15px 0;
        }
        
        .security {
            background-color: #ffebee;
            padding: 15px;
            border-left: 4px solid #f44336;
            margin: 15px 0;
        }
        
        strong {
            color: #2c3e50;
        }
        
        .section-number {
            color: #fd7e14;
            font-weight: bold;
        }
        
        .format-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .format-card {
            background-color: #f8f9fa;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }
        
        .format-card h4 {
            color: #fd7e14;
            margin-top: 0;
        }
        
        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
                padding: 0;
            }
            .format-comparison {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Полиморфизъм — 12б, ООП</h1>

        <h2><span class="section-number">1. Увод</span></h2>
        <div class="important">
            <p>Полиморфизмът е принцип на ООП, който позволява обекти от различни типове да се третират като обекти от общ базов тип, като всеки обект изпълнява същите операции по различен начин.</p>
        </div>

        <h2><span class="section-number">2. Какво е полиморфизъм?</span></h2>
        <div class="config">
            <h4>Полиморфизмът означава:</h4>
            <ul>
                <li><strong>Един интерфейс</strong> - различни имплементации</li>
                <li><strong>Позднно свързване</strong> - решението се взема по време на изпълнение</li>
                <li><strong>Гъвкавост</strong> - лесно добавяне на нови типове</li>
                <li><strong>Преизползване</strong> - един код работи с различни обекти</li>
                <li><strong>Разширяемост</strong> - лесно добавяне на нова функционалност</li>
            </ul>
        </div>

        <h2><span class="section-number">3. Видове полиморфизъм</span></h2>
        
        <div class="format-comparison">
            <div class="format-card">
                <h4>Compile-time полиморфизъм</h4>
                <ul>
                    <li>Методно претоварване</li>
                    <li>Операторно претоварване</li>
                    <li>Шаблонни функции</li>
                    <li>Решението се взема по време на компилация</li>
                </ul>
            </div>
            <div class="format-card">
                <h4>Runtime полиморфизъм</h4>
                <ul>
                    <li>Virtual методи</li>
                    <li>Override методи</li>
                    <li>Интерфейси</li>
                    <li>Решението се взема по време на изпълнение</li>
                </ul>
            </div>
        </div>

        <h2><span class="section-number">4. Compile-time полиморфизъм</span></h2>
        
        <div class="config">
            <h4>Методно претоварване (Method Overloading):</h4>
            <ul>
                <li><strong>Също име</strong> - различни параметри</li>
                <li><strong>Различни типове</strong> - int, string, double</li>
                <li><strong>Различен брой параметри</strong> - 1, 2, 3 параметъра</li>
                <li><strong>Различни модификатори</strong> - ref, out, params</li>
            </ul>
        </div>

        <div class="example">
            <h4>Пример с методно претоварване:</h4>
            <pre><code>class Calculator {
    // Претоварване с различни типове
    public int Add(int a, int b) {
        Console.WriteLine("Извиква се Add(int, int)");
        return a + b;
    }
    
    public double Add(double a, double b) {
        Console.WriteLine("Извиква се Add(double, double)");
        return a + b;
    }
    
    public string Add(string a, string b) {
        Console.WriteLine("Извиква се Add(string, string)");
        return a + b;
    }
    
    // Претоварване с различен брой параметри
    public int Add(int a, int b, int c) {
        Console.WriteLine("Извиква се Add(int, int, int)");
        return a + b + c;
    }
    
    public int Add(params int[] numbers) {
        Console.WriteLine("Извиква се Add(params int[])");
        int sum = 0;
        foreach (int num in numbers) {
            sum += num;
        }
        return sum;
    }
    
    // Претоварване с различни модификатори
    public void ProcessValue(int value) {
        Console.WriteLine($"Обработва се стойност: {value}");
    }
    
    public void ProcessValue(ref int value) {
        value *= 2;
        Console.WriteLine($"Обработена стойност (ref): {value}");
    }
    
    public void ProcessValue(out int value) {
        value = 42;
        Console.WriteLine($"Създадена стойност (out): {value}");
    }
}

// Използване
Calculator calc = new Calculator();

// Различни типове
int result1 = calc.Add(5, 3);
double result2 = calc.Add(3.14, 2.71);
string result3 = calc.Add("Здравей", " Свят");

// Различен брой параметри
int result4 = calc.Add(1, 2, 3);
int result5 = calc.Add(1, 2, 3, 4, 5);

// Различни модификатори
int value = 10;
calc.ProcessValue(value);
calc.ProcessValue(ref value);
calc.ProcessValue(out int newValue);</code></pre>
        </div>

        <h2><span class="section-number">5. Runtime полиморфизъм</span></h2>
        
        <div class="config">
            <h4>Virtual и Override методи:</h4>
            <ul>
                <li><strong>Virtual</strong> - метод в базовия клас, който може да се пренапише</li>
                <li><strong>Override</strong> - пренаписване на виртуален метод</li>
                <li><strong>Позднно свързване</strong> - решението се взема по време на изпълнение</li>
                <li><strong>Полиморфизъм</strong> - различни обекти, различни имплементации</li>
            </ul>
        </div>

        <div class="example">
            <h4>Пример с virtual и override:</h4>
            <pre><code>// Базов клас
class Animal {
    protected string name;
    protected int age;
    
    public Animal(string name, int age) {
        this.name = name;
        this.age = age;
    }
    
    // Виртуален метод - може да се пренапише
    public virtual void MakeSound() {
        Console.WriteLine($"{name} издава звук...");
    }
    
    public virtual void Move() {
        Console.WriteLine($"{name} се движи...");
    }
    
    // Виртуален метод с връщане на стойност
    public virtual string GetInfo() {
        return $"Животно: {name}, {age} години";
    }
    
    // Обикновен метод - не може да се пренапише
    public void Sleep() {
        Console.WriteLine($"{name} спи...");
    }
}

// Производен клас
class Dog : Animal {
    private string breed;
    
    public Dog(string name, int age, string breed) : base(name, age) {
        this.breed = breed;
    }
    
    // Override на виртуалния метод
    public override void MakeSound() {
        Console.WriteLine($"{name} лае: Woof! Woof!");
    }
    
    public override void Move() {
        Console.WriteLine($"{name} тича на четири крака");
    }
    
    public override string GetInfo() {
        return base.GetInfo() + $", порода: {breed}";
    }
    
    // Нов метод специфичен за кучето
    public void Fetch() {
        Console.WriteLine($"{name} донесе топката!");
    }
}

// Друг производен клас
class Cat : Animal {
    private bool isIndoor;
    
    public Cat(string name, int age, bool isIndoor) : base(name, age) {
        this.isIndoor = isIndoor;
    }
    
    public override void MakeSound() {
        Console.WriteLine($"{name} мяука: Meow! Meow!");
    }
    
    public override void Move() {
        Console.WriteLine($"{name} се движи тихо и грациозно");
    }
    
    public override string GetInfo() {
        return base.GetInfo() + $", домашен: {(isIndoor ? "Да" : "Не")}";
    }
    
    // Нов метод специфичен за котката
    public void Climb() {
        Console.WriteLine($"{name} се качва на дърво");
    }
}

// Използване на полиморфизъм
Animal[] animals = {
    new Dog("Рекс", 3, "Лабрадор"),
    new Cat("Мурка", 2, true),
    new Dog("Бади", 1, "Джак Ръсел"),
    new Cat("Тигър", 4, false)
};

Console.WriteLine("=== Полиморфизъм в действие ===");
foreach (Animal animal in animals) {
    Console.WriteLine($"\n{animal.GetInfo()}");
    animal.MakeSound();
    animal.Move();
    
    // Проверка за конкретен тип
    if (animal is Dog dog) {
        dog.Fetch();
    } else if (animal is Cat cat) {
        cat.Climb();
    }
}</code></pre>
        </div>

        <h2><span class="section-number">6. Полиморфизъм с интерфейси</span></h2>
        
        <div class="config">
            <h4>Предимства на полиморфизма с интерфейси:</h4>
            <ul>
                <li><strong>Множествено наследяване</strong> - клас може да имплементира множество интерфейси</li>
                <li><strong>Гъвкавост</strong> - лесно добавяне на нови способности</li>
                <li><strong>Стандартизация</strong> - дефиниране на общи контракти</li>
                <li><strong>Тестване</strong> - лесно създаване на mock обекти</li>
            </ul>
        </div>

        <div class="example">
            <h4>Пример с полиморфизъм и интерфейси:</h4>
            <pre><code>// Интерфейс за летене
interface IFlyable {
    void Fly();
    double GetMaxAltitude();
}

// Интерфейс за плуване
interface ISwimmable {
    void Swim();
    double GetMaxDepth();
}

// Интерфейс за ходене
interface IWalkable {
    void Walk();
    double GetMaxSpeed();
}

// Базов клас за животни
class Animal {
    protected string name;
    protected int age;
    
    public Animal(string name, int age) {
        this.name = name;
        this.age = age;
    }
    
    public virtual void DisplayInfo() {
        Console.WriteLine($"Животно: {name}, {age} години");
    }
}

// Клас за птици
class Bird : Animal, IFlyable, IWalkable {
    private double maxAltitude;
    private double maxSpeed;
    
    public Bird(string name, int age, double maxAltitude, double maxSpeed) 
        : base(name, age) {
        this.maxAltitude = maxAltitude;
        this.maxSpeed = maxSpeed;
    }
    
    public void Fly() {
        Console.WriteLine($"{name} лети в небето");
    }
    
    public double GetMaxAltitude() {
        return maxAltitude;
    }
    
    public void Walk() {
        Console.WriteLine($"{name} ходи по земята");
    }
    
    public double GetMaxSpeed() {
        return maxSpeed;
    }
    
    public override void DisplayInfo() {
        base.DisplayInfo();
        Console.WriteLine($"Максимална височина: {maxAltitude}м");
        Console.WriteLine($"Максимална скорост: {maxSpeed} км/ч");
    }
}

// Клас за риби
class Fish : Animal, ISwimmable {
    private double maxDepth;
    
    public Fish(string name, int age, double maxDepth) : base(name, age) {
        this.maxDepth = maxDepth;
    }
    
    public void Swim() {
        Console.WriteLine($"{name} плува във водата");
    }
    
    public double GetMaxDepth() {
        return maxDepth;
    }
    
    public override void DisplayInfo() {
        base.DisplayInfo();
        Console.WriteLine($"Максимална дълбочина: {maxDepth}м");
    }
}

// Клас за водоплаващи птици
class Waterfowl : Animal, IFlyable, ISwimmable, IWalkable {
    private double maxAltitude;
    private double maxDepth;
    private double maxSpeed;
    
    public Waterfowl(string name, int age, double maxAltitude, double maxDepth, double maxSpeed) 
        : base(name, age) {
        this.maxAltitude = maxAltitude;
        this.maxDepth = maxDepth;
        this.maxSpeed = maxSpeed;
    }
    
    public void Fly() {
        Console.WriteLine($"{name} лети над водата");
    }
    
    public double GetMaxAltitude() {
        return maxAltitude;
    }
    
    public void Swim() {
        Console.WriteLine($"{name} плува в езерото");
    }
    
    public double GetMaxDepth() {
        return maxDepth;
    }
    
    public void Walk() {
        Console.WriteLine($"{name} ходи по брега");
    }
    
    public double GetMaxSpeed() {
        return maxSpeed;
    }
    
    public override void DisplayInfo() {
        base.DisplayInfo();
        Console.WriteLine($"Максимална височина: {maxAltitude}м");
        Console.WriteLine($"Максимална дълбочина: {maxDepth}м");
        Console.WriteLine($"Максимална скорост: {maxSpeed} км/ч");
    }
}

// Използване на полиморфизъм с интерфейси
Animal[] animals = {
    new Bird("Орел", 5, 3000, 80),
    new Fish("Златна рибка", 2, 10),
    new Waterfowl("Паток", 3, 1000, 5, 15)
};

Console.WriteLine("=== Полиморфизъм с интерфейси ===");
foreach (Animal animal in animals) {
    Console.WriteLine($"\n{animal.GetType().Name}:");
    animal.DisplayInfo();
    
    // Полиморфизъм с интерфейси
    if (animal is IFlyable flyable) {
        flyable.Fly();
        Console.WriteLine($"Максимална височина: {flyable.GetMaxAltitude()}м");
    }
    
    if (animal is ISwimmable swimmable) {
        swimmable.Swim();
        Console.WriteLine($"Максимална дълбочина: {swimmable.GetMaxDepth()}м");
    }
    
    if (animal is IWalkable walkable) {
        walkable.Walk();
        Console.WriteLine($"Максимална скорост: {walkable.GetMaxSpeed()} км/ч");
    }
}</code></pre>
        </div>

        <h2><span class="section-number">7. Пълен пример - Система за плащания</span></h2>
        
        <div class="highlight">
            <h4>Реален пример с полиморфизъм:</h4>
            <pre><code>// Интерфейс за плащания
interface IPayment {
    decimal Amount { get; set; }
    string Currency { get; set; }
    bool ProcessPayment();
    string GetPaymentDetails();
}

// Интерфейс за валидация
interface IValidatable {
    bool IsValid { get; }
    List<string> ValidationErrors { get; }
    bool Validate();
}

// Интерфейс за нотификации
interface INotifiable {
    event EventHandler<string> PaymentProcessed;
    void SendNotification(string message);
}

// Базов клас за плащания
public abstract class PaymentBase : IPayment, IValidatable, INotifiable {
    public decimal Amount { get; set; }
    public string Currency { get; set; }
    public bool IsValid { get; protected set; }
    public List<string> ValidationErrors { get; protected set; }
    
    public event EventHandler<string> PaymentProcessed;
    
    protected PaymentBase(decimal amount, string currency) {
        Amount = amount;
        Currency = currency;
        ValidationErrors = new List<string>();
        IsValid = false;
    }
    
    // Абстрактен метод - трябва да се имплементира
    public abstract bool ProcessPayment();
    
    // Виртуален метод - може да се override
    public virtual string GetPaymentDetails() {
        return $"Плащане: {Amount:C} {Currency}";
    }
    
    // Виртуален метод за валидация
    public virtual bool Validate() {
        ValidationErrors.Clear();
        
        if (Amount <= 0) {
            ValidationErrors.Add("Сумата трябва да е положителна");
        }
        
        if (string.IsNullOrEmpty(Currency)) {
            ValidationErrors.Add("Валутата не може да бъде празна");
        }
        
        IsValid = ValidationErrors.Count == 0;
        return IsValid;
    }
    
    // Виртуален метод за нотификации
    public virtual void SendNotification(string message) {
        Console.WriteLine($"Изпратено уведомление: {message}");
        PaymentProcessed?.Invoke(this, message);
    }
    
    // Защитен метод за обща логика
    protected virtual void OnPaymentProcessed() {
        Console.WriteLine("Плащането е обработено успешно");
        SendNotification($"Плащането от {Amount:C} е завършено");
    }
}

// Конкретна имплементация за кредитна карта
public class CreditCardPayment : PaymentBase {
    public string CardNumber { get; set; }
    public string CardHolderName { get; set; }
    public DateTime ExpiryDate { get; set; }
    public string CVV { get; set; }
    
    public CreditCardPayment(decimal amount, string currency, string cardNumber, 
                           string cardHolderName, DateTime expiryDate, string cvv) 
                           : base(amount, currency) {
        CardNumber = cardNumber;
        CardHolderName = cardHolderName;
        ExpiryDate = expiryDate;
        CVV = cvv;
    }
    
    public override bool ProcessPayment() {
        if (!Validate()) {
            Console.WriteLine("Плащането не е валидно");
            return false;
        }
        
        Console.WriteLine("Обработва се плащане с кредитна карта...");
        
        if (SimulatePaymentProcessing()) {
            OnPaymentProcessed();
            return true;
        }
        
        Console.WriteLine("Плащането е неуспешно");
        return false;
    }
    
    public override string GetPaymentDetails() {
        return base.GetPaymentDetails() + 
               $"\nКарта: {MaskCardNumber(CardNumber)}" +
               $"\nПритежател: {CardHolderName}" +
               $"\nИзтича: {ExpiryDate:MM/yyyy}";
    }
    
    public override bool Validate() {
        bool baseValid = base.Validate();
        
        if (string.IsNullOrEmpty(CardNumber) || CardNumber.Length != 16) {
            ValidationErrors.Add("Невалиден номер на карта");
        }
        
        if (string.IsNullOrEmpty(CardHolderName)) {
            ValidationErrors.Add("Името на притежателя не може да бъде празно");
        }
        
        if (ExpiryDate < DateTime.Now) {
            ValidationErrors.Add("Картата е изтекла");
        }
        
        if (string.IsNullOrEmpty(CVV) || CVV.Length != 3) {
            ValidationErrors.Add("Невалиден CVV код");
        }
        
        IsValid = baseValid && ValidationErrors.Count == 0;
        return IsValid;
    }
    
    private bool SimulatePaymentProcessing() {
        return new Random().Next(1, 10) > 2; // 80% успех
    }
    
    private string MaskCardNumber(string cardNumber) {
        if (cardNumber.Length < 8) return "****";
        return cardNumber.Substring(0, 4) + " **** **** " + cardNumber.Substring(cardNumber.Length - 4);
    }
}

// Конкретна имплементация за банков превод
public class BankTransferPayment : PaymentBase {
    public string BankName { get; set; }
    public string AccountNumber { get; set; }
    public string RoutingNumber { get; set; }
    
    public BankTransferPayment(decimal amount, string currency, string bankName, 
                             string accountNumber, string routingNumber) 
                             : base(amount, currency) {
        BankName = bankName;
        AccountNumber = accountNumber;
        RoutingNumber = routingNumber;
    }
    
    public override bool ProcessPayment() {
        if (!Validate()) {
            Console.WriteLine("Плащането не е валидно");
            return false;
        }
        
        Console.WriteLine("Обработва се банков превод...");
        
        if (SimulateBankTransfer()) {
            OnPaymentProcessed();
            return true;
        }
        
        Console.WriteLine("Банковият превод е неуспешен");
        return false;
    }
    
    public override string GetPaymentDetails() {
        return base.GetPaymentDetails() + 
               $"\nБанка: {BankName}" +
               $"\nСметка: {MaskAccountNumber(AccountNumber)}" +
               $"\nРутинг: {RoutingNumber}";
    }
    
    public override bool Validate() {
        bool baseValid = base.Validate();
        
        if (string.IsNullOrEmpty(BankName)) {
            ValidationErrors.Add("Името на банката не може да бъде празно");
        }
        
        if (string.IsNullOrEmpty(AccountNumber) || AccountNumber.Length < 8) {
            ValidationErrors.Add("Невалиден номер на сметка");
        }
        
        if (string.IsNullOrEmpty(RoutingNumber) || RoutingNumber.Length != 9) {
            ValidationErrors.Add("Невалиден рутинг номер");
        }
        
        IsValid = baseValid && ValidationErrors.Count == 0;
        return IsValid;
    }
    
    private bool SimulateBankTransfer() {
        return new Random().Next(1, 10) > 1; // 90% успех
    }
    
    private string MaskAccountNumber(string accountNumber) {
        if (accountNumber.Length < 4) return "****";
        return "****" + accountNumber.Substring(accountNumber.Length - 4);
    }
}

// Конкретна имплементация за кеш
public class CashPayment : PaymentBase {
    public decimal AmountReceived { get; set; }
    public decimal Change { get; private set; }
    
    public CashPayment(decimal amount, string currency, decimal amountReceived) 
        : base(amount, currency) {
        AmountReceived = amountReceived;
        Change = 0;
    }
    
    public override bool ProcessPayment() {
        if (!Validate()) {
            Console.WriteLine("Плащането не е валидно");
            return false;
        }
        
        Console.WriteLine("Обработва се плащане в брой...");
        
        if (AmountReceived >= Amount) {
            Change = AmountReceived - Amount;
            OnPaymentProcessed();
            return true;
        } else {
            Console.WriteLine("Недостатъчна сума");
            return false;
        }
    }
    
    public override string GetPaymentDetails() {
        return base.GetPaymentDetails() + 
               $"\nПолучено: {AmountReceived:C}" +
               $"\nРесто: {Change:C}";
    }
    
    public override bool Validate() {
        bool baseValid = base.Validate();
        
        if (AmountReceived < 0) {
            ValidationErrors.Add("Получената сума не може да бъде отрицателна");
        }
        
        IsValid = baseValid && ValidationErrors.Count == 0;
        return IsValid;
    }
}

// Клас за обработка на плащания
public class PaymentProcessor {
    public void ProcessPayments(List<IPayment> payments) {
        Console.WriteLine("=== Обработка на плащания ===");
        
        foreach (var payment in payments) {
            Console.WriteLine($"\n{payment.GetType().Name}:");
            Console.WriteLine(payment.GetPaymentDetails());
            
            if (payment.ProcessPayment()) {
                Console.WriteLine("✓ Плащането е успешно");
            } else {
                Console.WriteLine("✗ Плащането е неуспешно");
                
                if (payment is IValidatable validatable) {
                    Console.WriteLine("Грешки при валидация:");
                    foreach (var error in validatable.ValidationErrors) {
                        Console.WriteLine($"  - {error}");
                    }
                }
            }
        }
    }
    
    public void ProcessPaymentsByType(List<IPayment> payments) {
        Console.WriteLine("\n=== Обработка по тип ===");
        
        var creditCardPayments = payments.OfType<CreditCardPayment>();
        var bankTransferPayments = payments.OfType<BankTransferPayment>();
        var cashPayments = payments.OfType<CashPayment>();
        
        Console.WriteLine($"Кредитни карти: {creditCardPayments.Count()}");
        Console.WriteLine($"Банкови преводи: {bankTransferPayments.Count()}");
        Console.WriteLine($"Плащания в брой: {cashPayments.Count()}");
    }
}

// Използване
var payments = new List<IPayment> {
    new CreditCardPayment(1000, "BGN", "1234567890123456", 
                         "Иван Петров", DateTime.Now.AddYears(2), "123"),
    new BankTransferPayment(500, "BGN", "Добротворна банка", 
                           "1234567890", "123456789"),
    new CashPayment(200, "BGN", 250),
    new CreditCardPayment(1500, "BGN", "9876543210987654", 
                         "Мария Георгиева", DateTime.Now.AddYears(1), "456")
};

var processor = new PaymentProcessor();
processor.ProcessPayments(payments);
processor.ProcessPaymentsByType(payments);

// Полиморфизъм с интерфейси
Console.WriteLine("\n=== Полиморфизъм с интерфейси ===");
foreach (var payment in payments) {
    if (payment is IValidatable validatable) {
        Console.WriteLine($"{payment.GetType().Name} валиден: {validatable.IsValid}");
    }
    
    if (payment is INotifiable notifiable) {
        notifiable.PaymentProcessed += (sender, message) => {
            Console.WriteLine($"Получено уведомление: {message}");
        };
    }
}</code></pre>
        </div>

        <h2><span class="section-number">8. Предимства на полиморфизма</span></h2>
        
        <div class="patterns">
            <h4>Ключови предимства:</h4>
            <ul>
                <li><strong>Гъвкавост</strong> - лесно добавяне на нови типове</li>
                <li><strong>Преизползване</strong> - един код работи с различни обекти</li>
                <li><strong>Поддръжка</strong> - лесно модифициране на функционалността</li>
                <li><strong>Тестване</strong> - лесно създаване на mock обекти</li>
                <li><strong>Разширяемост</strong> - лесно добавяне на нова функционалност</li>
            </ul>
        </div>

        <h2><span class="section-number">9. Практически задачи</span></h2>
        <div class="highlight">
            <h4>Задачи за упражнение:</h4>
            <ul>
                <li><strong>Създай йерархия от класове</strong> - Vehicle -> Car, Motorcycle, Truck</li>
                <li><strong>Имплементирай полиморфизъм</strong> - различни методи за Start, Stop, Accelerate</li>
                <li><strong>Направи интерфейс IShape</strong> - с методи CalculateArea, CalculatePerimeter</li>
                <li><strong>Създай полиморфна система</strong> - за различни геометрични фигури</li>
                <li><strong>Имплементирай полиморфизъм</strong> - за различни типове документи</li>
            </ul>
        </div>

        <h2><span class="section-number">10. Заключение</span></h2>
        <div class="important">
            <p>Полиморфизмът е мощна функционалност, която ни позволява да създаваме гъвкав, преизползваем и лесен за поддръжка код, който работи с различни типове обекти чрез един интерфейс.</p>
        </div>

        <div class="patterns">
            <h4>Ключови принципи:</h4>
            <ul>
                <li><strong>Един интерфейс</strong> - различни имплементации</li>
                <li><strong>Позднно свързване</strong> - решението се взема по време на изпълнение</li>
                <li><strong>Гъвкавост</strong> - лесно добавяне на нови типове</li>
                <li><strong>Преизползване</strong> - един код за множество обекти</li>
                <li><strong>Разширяемост</strong> - лесно добавяне на нова функционалност</li>
            </ul>
        </div>
    </div>
</body>
</html>
